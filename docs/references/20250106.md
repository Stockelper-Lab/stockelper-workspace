**일시**: 2025-01-05 20:00

**장소/플랫폼**: 가짜연구소 디스코드 Room-GH

**작성자**: 정영상

**참석자**: @정영상 @전태현 @희주 김 @Austin @HIMCHAN LEE @JEONG MINWOO @김현우 (Kim Hyeonwoo) 

# 회의 내용

## 개발 현황

- t3.small
    - 프론트엔드 서버
        - 채팅창 추가 완료 + 서브그래프 보여주는 화면 구현 완료
        - 포트폴리오 추천 결과 페이지 추가 완료
        - 백테스팅 결과 페이지 추가 예정
- t3.medium
    - LLM 서버
        - 기존 기능들이 제대로 작동하는지 확인하기
    - PostgreSQL
        - 유저 정보 DB
        - 백테스팅, 포트폴리오 추천 결과
- 로컬 서버(230 서버)
    - Neo4j
    - PostgreSQL
        - 공시 정보
        - 주가 정보
    - Airflow
        - 리포트 수집 크롤러 DAG(daily)
        - 주가 정보 수집 DAG(daily) → 매일 오후 5시에 수집하도록 수정 필요
        - DART 공시정보 수집 DAG(Backfill)
        - 로그 청소 DAG(daily)
        - DART 공시정보 수집 DAG(daily) → 개발 필요
        - Neo4j 지식그래프에 데이터 적재하는 DAG → 수정 필요
            - 수정된 온톨로지로 매일 업데이트
    - 포트폴리오 추천 API
        - 구현 완료 하였으나, 결과를 t3.medium에 있는 public.portfolio_recommendations에 적재하기
        - 적재할 때 UUID를 생성하여 job_id 컬럼에 추가하기
        - 요청을 받자마자 데이터를 전송하여 빈 ROW를 먼저 만들고, 이후 결과가 나오면 해당 UUID에 업데이트하기
    - 백테스트 API
        - 수집된 공시정보 데이터를 가지고 백테스팅 코드 구현 예정
        - 공시정보는 PostgreSQL에서 바로 사용하도록 하기
        - 백테스팅 코드 구현이 완료되면 포트폴리오 추천 API처럼 작동하도록 만들기

## 방식 변경

- 기존 방식
    - 뉴스 데이터에서 감성지수 추출 → 지식그래프에 날짜 데이터에 맞게 적재 → 백테스팅에 사용
    - 공시정보 데이터로부터 이벤트(온톨로지에 맞게) 추출 → 온톨로지에 따라 지식그래프에 적재 → 백테스팅에 사용
- 변동 방식
    - 공시정보 데이터의 카테고리 자체를 이벤트로 지정
    - 해당 이벤트들로 온톨로지 변경하기
        - 이전에 만들어놨던 온톨로지는 추후 뉴스데이터에서 이벤트를 추출해야 하므로 남겨두기
    - 공시정보 데이터로부터 백테스팅 유의 공시 분류 및 활용 지표 추출하기
        
        
        | **공시번호** | **공시명** | **활용 지표** |
        | --- | --- | --- |
        | **6** | 유상증자 결정 | 유상증자_조달비율, 유상증자_희석률 |
        | **7** | 무상증자 결정 | 무상증자_배정비율 |
        | **8** | 유무상증자 결정 | 6번+7번 지표 통합 (유상/무상 각각 계산) |
        | **9** | 감자 결정 | 감자_비율 |
        | **16** | 전환사채권 발행결정 | CB_발행비율, CB_전환희석률 |
        | **17** | 신주인수권부사채권 발행결정 | BW_발행비율 |
        | **21** | 자기주식 취득 결정 | 자사주_취득비율 |
        | **22** | 자기주식 처분 결정 | 자사주_처분비율 |
        | **23** | 자기주식취득 신탁계약 체결 결정 | 자사주신탁_체결비율 |
        | **24** | 자기주식취득 신탁계약 해지 결정 | 자사주신탁_해지비율 |
        | **25** | 영업양수 결정 | 영업양수_비율 |
        | **26** | 영업양도 결정 | 영업양도_비율 |
        | **29** | 타법인 주식 및 출자증권 양수결정 | 타법인양수_자기자본비 |
        | **30** | 타법인 주식 및 출자증권 양도결정 | 타법인양도_자기자본비 |
        | **33** | 회사합병 결정 | 합병_비율 |
        | **34** | 회사분할 결정 | 분할_비율 |
        | **35** | 회사분할합병 결정 | 분할합병_비율 |
        | **36** | 주식교환·이전 결정 | 주식교환이전_비율 |
        
        ### 증자/감자 관련 지표(6, 7, 8, 9)
        
        | **공시** | **지표명** | **계산식** | **활용 필드** |
        | --- | --- | --- | --- |
        | 유상증자 | **유상증자 조달비율** | (fdpp_fclt + fdpp_op + fdpp_dtrp + fdpp_ocsa + fdpp_etc) / 시가총액 | 자금조달 총액 |
        | 유상증자 | **희석률** | nstk_ostk_cnt / bfic_tisstk_ostk | 신주수 / 증자전 발행주식수 |
        | 무상증자 | **무상증자 배정비율** | nstk_ascnt_ps_ostk (1주당 신주배정 주식수) | 직접 활용 가능 |
        | 감자 | **감자비율** | cr_rt_ostk | API에서 직접 제공 |
        | 감자 | **자본금 감소율** | (bfcr_cpt - atcr_cpt) / bfcr_cpt | 감자전후 자본금 |
        
        ### 전환사채/신주인수권부사채 발행 관련 지표(16, 17)
        
        | **공시** | **지표명** | **계산식** | **활용 필드** |
        | --- | --- | --- | --- |
        | 전환사채 | **CB 발행비율** | bd_fta / 시가총액 | 사채 권면총액 |
        | 전환사채 | **전환희석률** | cvisstk_tisstk_vs (주식총수 대비 비율) | API에서 직접 제공 |
        | 전환사채 | **전환가 괴리율** | (현재주가 - cv_prc) / 현재주가 | 전환가액 |
        | 신주인수권부사채 | **BW 발행비율** | bd_fta / 시가총액 | 사채 권면총액 |
        | 신주인수권부사채 | **BW 희석률** | nstk_isstk_tisstk_vs (주식총수 대비 비율) | API에서 직접 제공 |
        
        ### 자기주식 관련(21, 22, 23, 24)
        
        | **공시** | **지표명** | **계산식** | **활용 필드** |
        | --- | --- | --- | --- |
        | 자기주식 취득 | **취득금액 비율** | aqpln_prc_ostk / 시가총액 | 취득예정금액 |
        | 자기주식 취득 | **취득주식 비율** | aqpln_stk_ostk / 발행주식총수 | 취득예정주식수 |
        | 자기주식 처분 | **처분금액 비율** | dppln_prc_ostk / 시가총액 | 처분예정금액 |
        | 자기주식 처분 | **처분주식 비율** | dppln_stk_ostk / 발행주식총수 | 처분예정주식수 |
        | 자기주식 신탁 체결 | **신탁계약 비율** | ctr_prc / 시가총액 | 계약금액 |
        | 자기주식 신탁 해지 | **신탁해지 비율** | ctr_prc_bfcc / 시가총액 | 해지전 계약금액 |
        
        ### 영업/타법인 주식 양수도(25, 26, 29, 30)
        
        | **공시** | **지표명** | **계산식** | **활용 필드** |
        | --- | --- | --- | --- |
        | 영업양수 | **양수가액 비율** | inh_prc / 시가총액 | 양수가액 |
        | 영업양수 | **자산비중** | ast_rt (양수대상 영업부문/당사전체) | API에서 직접 제공 |
        | 영업양도 | **양도가액 비율** | trf_prc / 시가총액 | 양도가액 |
        | 영업양도 | **자산비중** | ast_rt | API에서 직접 제공 |
        | 타법인주식 양수 | **양수금액 비율** | inhdtl_inhprc / 시가총액 | 양수금액 |
        | 타법인주식 양수 | **총자산대비** | inhdtl_tast_vs | API에서 직접 제공 |
        | 타법인주식 양수 | **자기자본대비** | inhdtl_ecpt_vs | API에서 직접 제공 |
        | 타법인주식 양도 | **양도금액 비율** | trfdtl_trfprc / 시가총액 | 양도금액 |
        | 타법인주식 양도 | **총자산대비** | trfdtl_tast_vs | API에서 직접 제공 |
        |  |  |  |  |
        
        ### 합병/분할/주식교환(33, 34, 35, 36)
        
        | **공시** | **지표명** | **계산식** | **활용 필드** |
        | --- | --- | --- | --- |
        | 회사합병 | **합병비율** | mg_rt | API에서 직접 제공 |
        | 회사합병 | **피합병사 자본대비** | rbsnfdtl_teqt / 당사 자기자본 | 합병상대회사 자본총계 |
        | 회사분할 | **분할비율** | dv_rt | API에서 직접 제공 |
        | 회사분할 | **분할후 자본비율** | ffdtl_teqt / atdvfdtl_teqt | 분할설립/존속회사 자본총계 |
        | 회사분할합병 | **분할합병비율** | dvmg_rt | API에서 직접 제공 |
        | 주식교환이전 | **교환이전비율** | extr_rt | API에서 직접 제공 |
    - 해당 지표를 기준으로 백테스팅
        - 백테스팅 조건은 사용자가 임의로 지정할 수 있게 하기
            - (그런데 이 부분도 에이전트가 결정해주면 좋을 듯 → 추후 개발 예정)
    - 공시정보 데이터를 지식그래프에 추가(공시 분류 및 활용 지표)
    - 추후 GraphRAG에 사용

### 개발 내용 변동에 따른 이슈

- 뉴스 데이터는 추후 수집
- 이에 맞춰 이벤트 추출 로직과 감성지수 추출 로직, 그리고 이와 관련된 모든 온톨로지는 보류
- 변동된 이후 온톨로지의 이벤트는 전부 공시정보 카테고리로 바뀌게 됨
- 따라서, airflow의 이벤트 추출 및 감성지수 관련 DAG는 제거하기